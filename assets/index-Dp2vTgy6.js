import{A as n,c as T,B,C as F,o as i,j as g,w as r,b as o,D as v,E as L,G as M,a as x,i as y,F as w,H as P,p as S,I as h,n as z,v as A,J as j,s as I,t as N,K as R,z as H}from"./index-cUmXSPEJ.js";import{P as U}from"./PostCard-CKCNDN5m.js";import{b as _}from"./route-block-B_A1xBdJ.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-boring-avatars-B0ASY4lP.js";const J=4,b={__name:"index",setup(K){const{api:C}=H(),c=n([]),l=n(""),s=n("全部"),V=["全部","紀念繪畫","回憶拼貼","故事攝影","物品改造","其他"];let u=!1;const k=T(()=>c.value.filter(a=>{const t=a.title.toLowerCase().includes(l.value.toLowerCase()),m=s.value==="全部"||a.category===s.value;return t&&m})),d=async()=>{if(!u){u=!0;try{const{data:e}=await C.get("/post",{params:{offset:c.value.length,limit:J}});e&&e.result?c.value.push(...e.result):console.error("無效的回應格式",e)}catch(e){console.log(e)}finally{u=!1}}},f=()=>{if(s.value!=="全部")return;const e=p.value;e&&e.getBoundingClientRect().top<=window.innerHeight&&(console.log("觸發加載更多文章"),d()),E.value=window.scrollY>300},p=n(null);B(()=>{window.addEventListener("scroll",f),d()}),F(()=>{window.removeEventListener("scroll",f)});const E=n(!1),D=()=>{window.scrollTo({top:0,behavior:"smooth"})};return(e,a)=>(i(),g(z,null,{default:r(()=>[o(P,{class:"d-flex justify-center",style:{width:"100%",gap:"5px","margin-top":"20px"}},{default:r(()=>[o(v,{cols:"12",class:"d-flex align-center justify-center",style:{height:"100px"}},{default:r(()=>[o(L,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=t=>l.value=t),"prepend-inner-icon":"mdi-magnify",density:"comfortable","single-line":"",color:"#EDE5D2",style:M({width:l.value.length>0?"350px":"100px",transition:"width 0.3s ease-in-out",textAlign:"left",marginLeft:l.value.length>0?"20px":"0px"}),class:"text-body-1 text-snow d-flex align-center me-4 search-bar"},null,8,["modelValue","style"]),(i(),x(w,null,y(V,t=>o(A,{key:t,class:j(["mx-2 text-body-2 ms-0",{"v-btn--active":s.value===t}]),style:{"max-width":"500px","line-height":"5px",color:"#EDE5D2"},variant:"tonal",onClick:m=>s.value=t},{default:r(()=>[I(N(t),1)]),_:2},1032,["class","onClick"])),64))]),_:1}),(i(!0),x(w,null,y(k.value,t=>(i(),g(v,{key:t._id,cols:"12",md:"6",lg:"3"},{default:r(()=>[o(U,R({ref_for:!0},t),null,16)]),_:2},1024))),128))]),_:1}),S("div",{ref_key:"loadMoreTrigger",ref:p,class:"load-more-trigger"},null,512),o(h,{class:"ms-4 custom-fab-plus",icon:"mdi-plus",location:"top end",size:"x-large",color:"#F1D87F",variant:"outlined"}),o(h,{icon:"mdi-arrow-up",location:"bottom left",variant:"outlined",absolute:"",class:"custom-fab-up",style:{margin:"16px"},color:"#F1D87F",onClick:D})]),_:1}))}};typeof _=="function"&&_(b);const W=G(b,[["__scopeId","data-v-71778bcf"]]);export{W as default};
