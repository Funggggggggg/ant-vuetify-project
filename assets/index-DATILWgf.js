import{_ as B,r as n,C as D,o as F,X as L,e as i,f as g,w as r,g as o,V as x,Y as M,s as P,m as v,H as y,I as h,x as S,h as A,Z as w,A as z,p as I,$ as N,v as R,t as j,M as H,B as U}from"./index-CyV538c9.js";import{P as Y}from"./PostCard-BCWDmYXA.js";import{b as _}from"./route-block-B_A1xBdJ.js";import"./vue-boring-avatars-f75Qd4DN.js";const $=4,b={__name:"index",setup(O){const{api:V}=U(),c=n([]),l=n(""),s=n("全部"),C=["全部","紀念繪畫","回憶拼貼","故事攝影","物品改造","其他"];let u=!1;const k=D(()=>c.value.filter(a=>{const t=a.title.toLowerCase().includes(l.value.toLowerCase()),m=s.value==="全部"||a.category===s.value;return t&&m})),d=async()=>{if(!u){u=!0;try{const{data:e}=await V.get("/post",{params:{offset:c.value.length,limit:$}});e&&e.result?(console.log("獲取的文章:",e.result),c.value.push(...e.result)):console.error("無效的回應格式",e)}catch(e){console.log(e)}finally{u=!1}}},f=()=>{if(s.value!=="全部")return;const e=p.value;e&&e.getBoundingClientRect().top<=window.innerHeight&&(console.log("觸發加載更多文章"),d()),E.value=window.scrollY>300},p=n(null);F(()=>{window.addEventListener("scroll",f),d()}),L(()=>{window.removeEventListener("scroll",f)});const E=n(!1),T=()=>{window.scrollTo({top:0,behavior:"smooth"})};return(e,a)=>(i(),g(z,null,{default:r(()=>[o(S,{class:"d-flex justify-center",style:{width:"100%",gap:"5px","margin-top":"20px"}},{default:r(()=>[o(x,{cols:"12",class:"d-flex align-center justify-center",style:{height:"100px"}},{default:r(()=>[o(M,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=t=>l.value=t),"prepend-inner-icon":"mdi-magnify",density:"comfortable","single-line":"",color:"#EDE5D2",style:P({width:l.value.length>0?"350px":"100px",transition:"width 0.3s ease-in-out",textAlign:"left",marginLeft:l.value.length>0?"20px":"0px"}),class:"text-body-1 text-snow d-flex align-center me-4 search-bar"},null,8,["modelValue","style"]),(i(),v(h,null,y(C,t=>o(I,{key:t,class:N(["mx-2 text-body-2 ms-0",{"v-btn--active":s.value===t}]),style:{"max-width":"500px","line-height":"5px",color:"#EDE5D2"},variant:"tonal",onClick:m=>s.value=t},{default:r(()=>[R(j(t),1)]),_:2},1032,["class","onClick"])),64))]),_:1}),(i(!0),v(h,null,y(k.value,t=>(i(),g(x,{key:t._id,cols:"12",md:"6",lg:"3"},{default:r(()=>[o(Y,H({ref_for:!0},t),null,16)]),_:2},1024))),128))]),_:1}),A("div",{ref_key:"loadMoreTrigger",ref:p,class:"load-more-trigger"},null,512),o(w,{class:"ms-4 custom-fab-plus",icon:"mdi-plus",location:"top end",size:"x-large",color:"#F1D87F",variant:"outlined"}),o(w,{icon:"mdi-arrow-up",location:"bottom left",variant:"outlined",absolute:"",class:"custom-fab-up",style:{margin:"16px"},color:"#F1D87F",onClick:T})]),_:1}))}};typeof _=="function"&&_(b);const J=B(b,[["__scopeId","data-v-ab8f26b8"]]);export{J as default};
