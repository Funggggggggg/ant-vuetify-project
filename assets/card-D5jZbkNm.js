import{u as $,c as L,K as S,T as q,r as z,C as k,e as o,f as v,w as s,g as t,V as u,h as f,t as l,i as m,H as D,m as h,J as E,G as C,p as d,v as g,x as R,A as T,I as j,a7 as F,j as G,k as H,B as J}from"./index-Bwj4HQoO.js";import{b as y}from"./route-block-B_A1xBdJ.js";const K={class:"text-center"},P={__name:"card",setup(U){const{apiAuth:n}=J(),i=$(),V=L(),b=S(),{t:w}=q(),c=z([]),p=async()=>{try{const{data:a}=await n.get("/user/card");c.value=a.result}catch(a){console.log(a)}};p();const x=k(()=>c.value.reduce((a,r)=>a+r.product.price*r.quantity,0)),B=k(()=>c.value.length>0&&c.value.every(a=>a.product.sell)),_=async(a,r)=>{try{const{data:e}=await n.patch("/user/card",{product:a,quantity:r});i.card=e.result,p()}catch(e){console.log(e)}},A=async()=>{var a,r;try{await n.post("/order"),i.card=0,V.push("/order")}catch(e){console.log(e),b({text:w("api."+(((r=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"#C04759"}})}};return(a,r)=>(o(),v(T,null,{default:s(()=>[t(R,null,{default:s(()=>[t(u,{cols:"12"},{default:s(()=>[f("h1",K,l(a.$t("nav.card")),1)]),_:1}),t(m),t(u,{cols:"12"},{default:s(()=>[t(D,{lines:"two"},{default:s(()=>[(o(!0),h(C,null,E(c.value,(e,I)=>(o(),h(C,{key:e._id},[t(j,{title:e.product.name,subtitle:e.product.price,"active-class":"bg-red",active:!e.product.sell},{prepend:s(()=>[t(F,{rounded:"0"},{default:s(()=>[t(G,{src:e.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[t(d,{color:"red",icon:"mdi-minus",size:"small",class:"ml-2",onClick:N=>_(e.product._id,-1)},null,8,["onClick"]),g(" "+l(e.quantity)+" ",1),t(d,{color:"#3B6C73",icon:"mdi-plus",size:"small",class:"mr-2",onClick:N=>_(e.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),I<c.value.length-1?(o(),v(m,{key:0})):H("",!0)],64))),128))]),_:1})]),_:1}),t(u,{cols:"12",class:"text-center"},{default:s(()=>[f("p",null,l(x.value),1),t(d,{color:"primary",disabled:!B.value,onClick:A},{default:s(()=>[g(l(a.$t("card.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof y=="function"&&y(P);export{P as default};
