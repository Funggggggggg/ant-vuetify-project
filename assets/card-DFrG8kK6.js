import{u as z,l as D,k as E,U as I,A as L,c as k,o,j as v,w as s,b as t,D as S,E as u,p as f,t as l,h,e as q,a as m,F as y,i as F,f as R,a2 as T,$ as U,v as d,s as C,x as j,n as P,T as g,z as G}from"./index-DcZYs0cM.js";const H={class:"text-center"},J={__name:"card",setup(K){const{apiAuth:n}=G(),i=z(),V=D(),b=E(),{t:w}=I(),r=L([]),p=async()=>{try{const{data:a}=await n.get("/user/card");r.value=a.result}catch(a){console.log(a)}};p();const x=k(()=>r.value.reduce((a,c)=>a+c.product.price*c.quantity,0)),B=k(()=>r.value.length>0&&r.value.every(a=>a.product.sell)),_=async(a,c)=>{try{const{data:e}=await n.patch("/user/card",{product:a,quantity:c});i.card=e.result,p()}catch(e){console.log(e)}},$=async()=>{var a,c;try{await n.post("/order"),i.card=0,V.push("/order")}catch(e){console.log(e),b({text:w("api."+(((c=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:c.message)||"unknownError")),snackbarProps:{color:"#C04759"}})}};return(a,c)=>(o(),v(P,null,{default:s(()=>[t(S,null,{default:s(()=>[t(u,{cols:"12"},{default:s(()=>[f("h1",H,l(a.$t("nav.card")),1)]),_:1}),t(h),t(u,{cols:"12"},{default:s(()=>[t(q,{lines:"two"},{default:s(()=>[(o(!0),m(y,null,F(r.value,(e,A)=>(o(),m(y,{key:e._id},[t(R,{title:e.product.name,subtitle:e.product.price,"active-class":"bg-red",active:!e.product.sell},{prepend:s(()=>[t(T,{rounded:"0"},{default:s(()=>[t(U,{src:e.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[t(d,{color:"red",icon:"mdi-minus",size:"small",class:"ml-2",onClick:N=>_(e.product._id,-1)},null,8,["onClick"]),C(" "+l(e.quantity)+" ",1),t(d,{color:"#3B6C73",icon:"mdi-plus",size:"small",class:"mr-2",onClick:N=>_(e.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),A<r.value.length-1?(o(),v(h,{key:0})):j("",!0)],64))),128))]),_:1})]),_:1}),t(u,{cols:"12",class:"text-center"},{default:s(()=>[f("p",null,l(x.value),1),t(d,{color:"primary",disabled:!B.value,onClick:$},{default:s(()=>[C(l(a.$t("card.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof g=="function"&&g(J);export{J as default};
