import{u as S,_ as D}from"./PostCard-By8cK80L.js";import{_ as E,r as u,C as h,u as I,b as T,ab as z,o as N,e as o,f as c,w as a,h as m,g as t,V as f,l as v,$ as L,a0 as M,t as _,p as y,a1 as R,x as C,m as U,J as $,G,ai as J,z as O,aj as q,k,ak as H,v as K,A as Q,S as W,B as X}from"./index-Bwj4HQoO.js";import{z as Y}from"./vue-boring-avatars-BeiWwWgF.js";const Z={class:"ma-8"},V=16,ee={__name:"userpage",setup(te){const{api:b}=X(),i=u(1),F=h(()=>Math.ceil(r.value.length/V)),p=I(),w=S(),d=T(),g=u(!1),x=u(null),r=u([]),j=u(""),l=u("created"),A=h(()=>r.value.filter(e=>l.value==="created"?e.user===d.params.id:w.collectedPosts.includes(e.id)).filter(e=>e.title.toLowerCase().includes(j.value.toLowerCase())).slice((i.value-1)*V,i.value*V)),P=async()=>{if(!d.params.id){console.error("無法獲取用戶 ID，請確認用戶是否已正確登錄");return}g.value=!0,x.value=null;try{const s=l.value==="created"?"/post/userposts/"+d.params.id:"/userCollect/collected/"+d.params.id;console.log("API 請求路徑:",s);const{data:e}=await b.get(s);if(!(e!=null&&e.result))throw new Error("無效的回應格式");r.value=e.result,console.log("獲取的文章:",r.value)}catch(s){console.error("獲取文章失敗:",s),s.value="無法取得文章資料",r.value=[]}finally{g.value=!1}};return z(l,()=>{i.value=1,P()}),N(async()=>{try{d.params.id?(await P(),await w.fetchCollectedPosts()):console.error("用戶 ID 未加載，無法獲取文章")}catch(s){console.error("初始化失敗:",s)}}),(s,e)=>{const B=D;return o(),c(Q,{style:{"margin-top":"50px"}},{default:a(()=>[m("div",Z,[t(C,{class:"d-flex justify-center align-center text-snow"},{default:a(()=>[t(f,{cols:"2"},{default:a(()=>[t(v(Y),{size:200,variant:"beam",name:v(p).account,title:!0,style:{"margin-right":"10px"}},null,8,["name"])]),_:1}),t(f,{cols:"6",style:{"margin-left":"50px"},class:"text-snow"},{default:a(()=>[t(L,{variant:"text",class:"d-flex flex-column text-h5 content"},{default:a(()=>[t(M,{style:{"margin-top":"10px"},class:"usrAccount"},{default:a(()=>[m("h2",null,_(v(p).account),1),t(y,{icon:"mdi-pencil",variant:"text",class:"text-snow"})]),_:1}),t(R,null,{default:a(()=>[m("p",null,_(v(p).introduce),1)]),_:1})]),_:1})]),_:1})]),_:1}),r.value.length>0?(o(),c(C,{key:0,class:"d-flex justify-center"},{default:a(()=>[t(f,{cols:"12",class:"d-flex justify-center align-center"},{default:a(()=>[t(y,{text:"已建立",class:"text-body-2 me-4 font-weight-bold rounded-lg",variant:l.value==="created"?"flat":"outlined",color:(l.value==="created","#F1D87F"),onClick:e[0]||(e[0]=n=>l.value="created")},null,8,["variant","color"]),t(y,{text:"已收藏",class:"text-body-2 ms-4 font-weight-bold rounded-lg",variant:l.value==="favorite"?"flat":"outlined",color:(l.value==="favorite","#C04759"),onClick:e[1]||(e[1]=n=>l.value="favorite")},null,8,["variant","color"])]),_:1}),(o(!0),U(G,null,$(A.value,n=>(o(),c(f,{key:n.id,cols:"12",md:"6",lg:"3",class:"mt-4"},{default:a(()=>[t(B,W({ref_for:!0},n,{account:v(p).account}),null,16,["account"])]),_:2},1024))),128)),t(f,{cols:"12"},{default:a(()=>[t(J,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=n=>i.value=n),length:F.value},null,8,["modelValue","length"])]),_:1})]),_:1})):(o(),c(C,{key:1,class:"d-flex justify-center text-center text-snow text-body-2"},{default:a(()=>e[3]||(e[3]=[m("p",null," 尚無文章 ",-1)])),_:1}))]),g.value?(o(),c(O,{key:0,class:"d-flex align-center justify-center"},{default:a(()=>[t(q,{indeterminate:""})]),_:1})):k("",!0),x.value?(o(),c(H,{key:1,type:"error",variant:"tonal",class:"ma-4"},{default:a(()=>[K(_(x.value),1)]),_:1})):k("",!0)]),_:1})}}},oe=E(ee,[["__scopeId","data-v-90155e84"]]);export{oe as default};
