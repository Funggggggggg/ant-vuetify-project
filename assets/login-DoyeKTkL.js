import{k,l as y,u as B,o as C,j as F,w as l,b as s,D as A,E as m,p as d,t as p,h as D,K as M,g as a,a0 as N,G as g,v as U,s as $,n as q,z as P}from"./index-BrPvT3NF.js";import{a as R,u as b}from"./vee-validate-g8Jfa14R.js";import{c as T,a as f}from"./index.esm-Yr44nOnA.js";import{v as j}from"./index-BZZVVzg9.js";import{b as v}from"./route-block-B_A1xBdJ.js";const z={class:"text-center"},E={__name:"login",setup(G){const{api:x}=P(),i=k(),V=y(),h=B(),w=T({account:f().required("使用者帳號必填").min(4,"使用者帳號太短").max(20,"使用者帳號太長").test("isAlphanumeric","使用者帳號格式不符",t=>j.isAlphanumeric(t)),password:f().required("使用者密碼必填").min(4,"使用者密碼太短").max(20,"使用者密碼太長")}),{handleSubmit:_,isSubmitting:c}=R({validationSchema:w}),n=b("account"),u=b("password"),S=_(async t=>{var e,o;try{const{data:r}=await x.post("/user/login",{account:t.account,password:t.password});h.login(r.result),i({text:"登入成功",snackbarProps:{color:"#3B6C73"}}),V.push("/")}catch(r){console.log(r),i({text:((o=(e=r==null?void 0:r.response)==null?void 0:e.data)==null?void 0:o.message)||"未知錯誤",snackbarProps:{color:"#C04759"}})}});return(t,e)=>(C(),F(q,null,{default:l(()=>[s(A,{class:"text-abril text-snow mt-8"},{default:l(()=>[s(m,{cols:"12"},{default:l(()=>e[2]||(e[2]=[d("h1",{class:"text-center text-h4"},p("登入"),-1)])),_:1}),s(D),s(m,{cols:"12"},{default:l(()=>[s(M,{disabled:a(c),onSubmit:N(a(S),["prevent"])},{default:l(()=>[s(g,{modelValue:a(n).value.value,"onUpdate:modelValue":e[0]||(e[0]=o=>a(n).value.value=o),"error-messages":a(n).errorMessage.value,label:"帳號",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),s(g,{modelValue:a(u).value.value,"onUpdate:modelValue":e[1]||(e[1]=o=>a(u).value.value=o),type:"password","error-messages":a(u).errorMessage.value,label:"密碼",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),d("div",z,[s(U,{loading:a(c),type:"submit",color:"#3B6C73"},{default:l(()=>[$(p(t.$t("login.submit")),1)]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof v=="function"&&v(E);export{E as default};
