import{k as B,l as M,o as F,j as U,w as t,b as o,E as f,p as V,t as b,h as _,J as q,g as a,a0 as A,G as n,v as D,s as E,D as N,n as $,z as P}from"./index-DditOydA.js";import{a as R,u}from"./vee-validate-BpowkEoJ.js";import{c as T,a as i,d as j}from"./index.esm-Z1WTQynD.js";import{v as x}from"./index-umIH2el4.js";import{b as w}from"./route-block-B_A1xBdJ.js";const z={class:"text-center"},G={__name:"register",setup(J){const{api:C}=P(),g=B(),h=M(),k=T({account:i().required("使用者帳號必填").min(4,"使用者帳號太短").max(20,"使用者帳號太長").test("isAlphanumeric","使用者帳號格式不符",r=>x.isAlphanumeric(r)),email:i().required("使用者信箱必填").test("isEmail","使用者信箱格式不符",r=>x.isEmail(r)),password:i().required("使用者密碼必填").min(4,"使用者密碼太短").max(20,"使用者密碼太長"),passwordConfirm:i().oneOf([j("password")],"密碼不符")}),{handleSubmit:y,isSubmitting:v}=R({validationSchema:k}),m=u("account"),d=u("email"),p=u("password"),c=u("passwordConfirm"),S=y(async r=>{var e,s;try{await C.post("/user",{account:r.account,email:r.email,password:r.password}),g({text:"註冊成功",snackbarProps:{color:"#3B6C73"}}),h.push("/login")}catch(l){console.log(l),g({text:((s=(e=l==null?void 0:l.response)==null?void 0:e.data)==null?void 0:s.message)||"未知錯誤",snackbarProps:{color:"#C04759"}})}});return(r,e)=>(F(),U($,null,{default:t(()=>[o(N,{class:"text-abril text-snow mt-8"},{default:t(()=>[o(f,{cols:"12"},{default:t(()=>e[4]||(e[4]=[V("h1",{class:"text-center text-h4"},b("註冊"),-1)])),_:1}),o(_),o(f,{cols:"12"},{default:t(()=>[o(q,{disabled:a(v),onSubmit:A(a(S),["prevent"])},{default:t(()=>[o(n,{modelValue:a(m).value.value,"onUpdate:modelValue":e[0]||(e[0]=s=>a(m).value.value=s),"error-messages":a(m).errorMessage.value,label:"帳號",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),o(n,{modelValue:a(d).value.value,"onUpdate:modelValue":e[1]||(e[1]=s=>a(d).value.value=s),"error-messages":a(d).errorMessage.value,label:"信箱"},null,8,["modelValue","error-messages"]),o(n,{modelValue:a(p).value.value,"onUpdate:modelValue":e[2]||(e[2]=s=>a(p).value.value=s),type:"password","error-messages":a(p).errorMessage.value,label:"密碼",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),o(n,{modelValue:a(c).value.value,"onUpdate:modelValue":e[3]||(e[3]=s=>a(c).value.value=s),type:"password","error-messages":a(c).errorMessage.value,label:"確認密碼",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),V("div",z,[o(D,{loading:a(v),type:"submit",color:"#3B6C73"},{default:t(()=>e[5]||(e[5]=[E(b("建立帳號"))])),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof w=="function"&&w(G);export{G as default};
