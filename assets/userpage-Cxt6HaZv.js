import{_ as N,b as U,u as j,r as d,C as _,D as A,o as z,e as u,w as a,V as G,g as n,j as x,h as l,i as f,m,E as R,F as L,t as V,q as C,f as w,G as $,y as P,n as q,H,I as J,J as K,A as O,K as Q,L as W,x as X,B as Y,M as Z}from"./index-BcYLqGWP.js";import{u as ee,P as te}from"./PostCard-CuDtMPL-.js";import{z as ae}from"./vue-boring-avatars-CG8H-h_g.js";import{b as B}from"./route-block-B_A1xBdJ.js";const le={class:"ma-8"},k=16,D={__name:"userpage",setup(se){const{api:E}=Y(),o=U(),F=j(),T=ee(),v=d(!1),y=d(null),c=d([]),i=d(1),p=j(),I=_(()=>Math.ceil(c.value.length/k)),M=_(()=>{var e;return((e=F.user)==null?void 0:e.id)===o.params.id});console.log("🛑 route.params:",o.params);const r=d("created"),b=_(()=>c.value.filter(e=>r.value==="created"?e.user.toString()===o.params.id:T.collectedPosts.includes(e._id)).slice((i.value-1)*k,i.value*k)),g=async()=>{if(console.log("route.params.id:",o.params.id),!o.params.id){console.error("❌ 無法獲取用戶 ID，請確認用戶是否已正確進入頁面");return}if(!v.value){v.value=!0,y.value=null;try{const e=r.value==="created"?"/post/userposts/"+o.params.id:"/userCollect/collected/"+o.params.id;console.log("🚀 API 請求路徑:",e);const{data:s}=await E.get(e);if(!(s!=null&&s.result))throw new Error("無效的回應格式");c.value=s.result,console.log("✅ 獲取的文章:",c.value)}catch(e){console.error("❌ 獲取文章失敗:",e),e.value="無法取得文章資料",c.value=[]}finally{v.value=!1}}},h=e=>{r.value!==e&&(r.value=e,i.value=1,g())};return A(r,g),A(()=>o.params.id,()=>{g()}),z(()=>{g()}),(e,s)=>(n(),u(G,{style:{"margin-top":"50px"}},{default:a(()=>[x("div",le,[l(P,{class:"d-flex justify-center align-center text-snow"},{default:a(()=>[l(f,{cols:"2"},{default:a(()=>{var t;return[l(m(ae),{size:200,variant:"beam",name:((t=m(p))==null?void 0:t.account)||"Guest",title:!0,style:{"margin-right":"10px"}},null,8,["name"])]}),_:1}),l(f,{cols:"6",style:{"margin-left":"50px"},class:"text-snow"},{default:a(()=>[l(R,{variant:"text",class:"d-flex flex-column text-h5 content"},{default:a(()=>[l(L,{style:{"margin-top":"10px"},class:"usrAccount"},{default:a(()=>{var t;return[x("h2",null,V(((t=m(p))==null?void 0:t.account)||"未知用戶"),1),M.value?(n(),u(C,{key:0,icon:"mdi-pencil",variant:"text",class:"text-snow"})):w("",!0)]}),_:1}),l($,null,{default:a(()=>{var t;return[x("p",null,V(((t=m(p))==null?void 0:t.introduce)||"尚無介紹"),1)]}),_:1})]),_:1})]),_:1}),l(f,{cols:"12",class:"d-flex justify-center align-center"},{default:a(()=>[l(C,{text:"已建立",class:"text-body-2 me-4 font-weight-bold rounded-lg",variant:r.value==="created"?"flat":"outlined",color:(r.value==="created","#F1D87F"),onClick:s[0]||(s[0]=t=>h("created"))},null,8,["variant","color"]),l(C,{text:"已收藏",class:"text-body-2 ms-4 font-weight-bold rounded-lg",variant:r.value==="favorite"?"flat":"outlined",color:(r.value==="favorite","#C04759"),onClick:s[1]||(s[1]=t=>h("favorite"))},null,8,["variant","color"])]),_:1})]),_:1}),b.value.length>0?(n(),u(P,{key:0,class:"d-flex justify-center"},{default:a(()=>[(n(!0),q(J,null,H(b.value,t=>(n(),u(f,{key:t.id,cols:"12",md:"6",lg:"3",class:"mt-4"},{default:a(()=>{var S;return[l(te,Z({ref_for:!0},t,{account:(S=m(p))==null?void 0:S.account}),null,16,["account"])]}),_:2},1024))),128)),l(f,{cols:"12"},{default:a(()=>[l(K,{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=t=>i.value=t),length:I.value},null,8,["modelValue","length"])]),_:1})]),_:1})):(n(),u(P,{key:1,class:"d-flex justify-center text-center text-snow text-body-2 mt-8"},{default:a(()=>s[3]||(s[3]=[x("p",null," 尚無文章 ",-1)])),_:1}))]),v.value?(n(),u(O,{key:0,class:"d-flex align-center justify-center"},{default:a(()=>[l(Q,{indeterminate:""})]),_:1})):w("",!0),y.value?(n(),u(W,{key:1,type:"error",variant:"tonal",class:"ma-4"},{default:a(()=>[X(V(y.value),1)]),_:1})):w("",!0)]),_:1}))}};typeof B=="function"&&B(D);const ce=N(D,[["__scopeId","data-v-378efb6f"]]);export{ce as default};
