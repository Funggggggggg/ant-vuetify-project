import{_ as B,r as n,C as D,o as F,O as L,e as c,f as m,w as r,g as o,V as v,P as M,s as S,m as x,J as _,G as h,x as P,h as A,Q as w,A as R,p as z,R as N,v as j,t as I,S as O,B as U}from"./index-Bwj4HQoO.js";import{_ as G}from"./PostCard-By8cK80L.js";import{b as y}from"./route-block-B_A1xBdJ.js";import"./vue-boring-avatars-BeiWwWgF.js";const H=4,b={__name:"index",setup(J){const{api:V}=U(),i=n([]),l=n(""),s=n("全部"),C=["全部","紀念繪畫","回憶拼貼","故事攝影","物品改造","其他"];let u=!1;const k=D(()=>{const e=i.value.filter(a=>{const t=a.title.toLowerCase().includes(l.value.toLowerCase()),g=s.value==="全部"||a.category===s.value;return t&&g});return console.log("過濾後的文章:",e),e}),d=async()=>{if(!u){u=!0;try{const{data:e}=await V.get("/post",{params:{offset:i.value.length,limit:H}});e&&e.result?(console.log("獲取的文章:",e.result),i.value.push(...e.result),console.log("當前文章列表:",i.value)):console.error("無效的回應格式",e)}catch(e){console.log(e)}u=!1}},f=()=>{if(s.value!=="全部")return;const e=p.value;e&&e.getBoundingClientRect().top<=window.innerHeight&&(console.log("觸發加載更多文章"),d()),E.value=window.scrollY>300},p=n(null);F(()=>{window.addEventListener("scroll",f),d()}),L(()=>{window.removeEventListener("scroll",f)});const E=n(!1),T=()=>{window.scrollTo({top:0,behavior:"smooth"})};return(e,a)=>(c(),m(R,null,{default:r(()=>[o(P,{class:"d-flex justify-center",style:{width:"100%",gap:"5px","margin-top":"20px"}},{default:r(()=>[o(v,{cols:"12",class:"d-flex align-center justify-center",style:{height:"100px"}},{default:r(()=>[o(M,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=t=>l.value=t),"prepend-inner-icon":"mdi-magnify",density:"comfortable","single-line":"",color:"#EDE5D2",style:S({width:l.value.length>0?"350px":"100px",transition:"width 0.3s ease-in-out",textAlign:"left",marginLeft:l.value.length>0?"20px":"0px"}),class:"text-body-1 text-snow d-flex align-center me-4 search-bar"},null,8,["modelValue","style"]),(c(),x(h,null,_(C,t=>o(z,{key:t,class:N(["mx-2 text-body-2 ms-0",{"v-btn--active":s.value===t}]),style:{"max-width":"500px","line-height":"5px",color:"#EDE5D2"},variant:"tonal",onClick:g=>s.value=t},{default:r(()=>[j(I(t),1)]),_:2},1032,["class","onClick"])),64))]),_:1}),(c(!0),x(h,null,_(k.value,t=>(c(),m(v,{key:t._id,cols:"12",md:"6",lg:"3"},{default:r(()=>[o(G,O({ref_for:!0},t),null,16)]),_:2},1024))),128))]),_:1}),A("div",{ref_key:"loadMoreTrigger",ref:p,class:"load-more-trigger"},null,512),o(w,{class:"ms-4 custom-fab-plus",icon:"mdi-plus",location:"top end",size:"x-large",color:"#F1D87F",variant:"outlined"}),o(w,{icon:"mdi-arrow-up",location:"bottom left",variant:"outlined",absolute:"",class:"custom-fab-up",style:{margin:"16px"},color:"#F1D87F",onClick:T})]),_:1}))}};typeof y=="function"&&y(b);const K=B(b,[["__scopeId","data-v-ae0a0474"]]);export{K as default};
