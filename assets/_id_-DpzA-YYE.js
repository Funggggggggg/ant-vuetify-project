import{a2 as B,A as t,u as z,a3 as I,a4 as A,l as D,B as P,o as p,j as h,w as o,b as l,D as b,p as r,t as c,h as F,Q as j,x as y,g as N,a as R,S as U,v as T,R as $,G as E,s as V,H as G,a5 as H,a6 as L,n as M,z as O}from"./index-CNGVU9B8.js";import{z as Q}from"./vue-boring-avatars-bLJrGqD0.js";import{b as w}from"./route-block-B_A1xBdJ.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J=B("card",()=>{const k=t(""),x=t(""),n=t(""),u=t(""),d=t(),m=t(),e=t(!1),g=t(!1),i=t(""),f=t(""),v=t([]);return{user:k,account:x,title:n,category:u,content:d,image:m,isPrivate:e,like:g,createdAt:i,updatedAt:f,cards:v,fetchUserCards:async()=>{const s=z();if(s.token)try{const a=await I.get(`/post/userposts/${s._id}`,{headers:{Authorization:`Bearer ${s.token}`}});v.value=a.data.result}catch(a){console.error("Failed to fetch cards:",a)}}}}),K={class:"text-center text-snow text-h3 mt-4 mb-4"},W={class:"border pa-3 rounded-xl"},X={class:"d-flex align-center mb-4 text-abril"},Y={class:"ms-4",style:{"font-size":"x-large"}},Z={class:"mb-4 text-body-1"},ee={key:0,class:"mb-4 text-body-2 text-abril"},C={__name:"[id]",setup(k){const{api:x}=O(),n=A(),u=D(),d=J(),m=t(!1),e=t({_id:"",account:"",title:"",content:"",image:"",category:"",isPrivate:!1,like:!1}),g=async()=>{try{const{data:s}=await x.get("/post/"+n.params.id);s&&s.result?(e.value=s.result,document.title=e.value.title+" | 紀念巢"):(console.error("API 回傳的資料不完整，將跳轉至首頁"),e.value={},u.push("/")),d.isLoggedIn&&(i.value=d.collected.some(a=>a.post.toString()===e.value._id))}catch(s){console.log(s),e.value={},u.push("/")}};P(async()=>{try{n.params.id?(console.log("獲取到的文章 ID:",n.params.id),await g()):(console.error("路由參數 ID 不存在，將跳轉至首頁"),u.push("/"))}catch(s){console.error("初始化失敗:",s),e.value={}}});const i=t(!1),f=t(!1),v=t(""),_=t({color:"#C04759",timeout:2e3,showCloseButton:!0});return(s,a)=>e.value&&e.value._id?(p(),h(M,{key:0},{default:o(()=>[l(G,{class:"d-flex justify-center align-center"},{default:o(()=>[l(b,{cols:"12"},{default:o(()=>[r("h1",K,c(e.value.title||"載入中..."),1)]),_:1}),l(F),l(b,{cols:"5",md:"6",class:"mt-8"},{default:o(()=>[r("div",W,[e.value.image?(p(),h(j,{key:0,src:e.value.image,class:"rounded-xl"},null,8,["src"])):y("",!0)])]),_:1}),l(b,{cols:"7",md:"6",class:"text-snow text-body-2 mt-4"},{default:o(()=>[r("div",X,[l(N(Q),{size:30,variant:"beam",name:e.value.account,title:!0},null,8,["name"]),r("div",Y,c(e.value.account||"訪客"),1)]),r("p",Z,c("分類："+(e.value.category||"無分類")),1),e.value.content?(p(),R("p",ee,c(e.value.content||"內容加載中..."),1)):y("",!0),l(U,{disabled:m.value,class:"w-100 d-flex align-center justify-end"},{default:o(()=>[l(T,{type:"submit",loading:m.value,variant:"text"},{default:o(()=>[e.value&&e.value._id?(p(),h($,{key:0,style:E({color:i.value?"#C04759":"#F1D87F",fontSize:"25px"}),left:"",class:"ms-1"},{default:o(()=>[V(c(i.value?"mdi-heart":"mdi-heart-outline"),1)]),_:1},8,["style"])):y("",!0)]),_:1},8,["loading"])]),_:1},8,["disabled"])]),_:1})]),_:1}),l(H,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=S=>f.value=S),timeout:_.value.timeout||2e3,color:_.value.color||"#C04759","show-close":_.value.showCloseButton||!1},{default:o(()=>[V(c(v.value),1)]),_:1},8,["modelValue","timeout","color","show-close"]),l(L,{"model-value":e.value.isPrivate,class:"align-center justify-center",scrim:"black",opacity:"0.8",persistent:""},{default:o(()=>a[1]||(a[1]=[r("h1",{class:"text-center"},"'私人卡片'",-1)])),_:1},8,["model-value"])]),_:1})):y("",!0)}};typeof w=="function"&&w(C);const le=q(C,[["__scopeId","data-v-fe159676"]]);export{le as default};
