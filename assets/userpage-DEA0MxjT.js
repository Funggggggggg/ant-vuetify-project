import{_ as z,a5 as M,u as T,A as d,c as _,ad as j,B as U,o as n,j as u,w as a,p as x,b as l,D as V,E as f,g as v,L as R,M as G,t as k,v as C,x as w,N as L,a as $,F as O,i as q,I as H,ak as J,a8 as K,al as Q,am as W,s as X,n as Y,T as A,z as Z}from"./index-DKuFUKrB.js";import{u as ee,P as te}from"./PostCard-B50sdNbJ.js";import{z as ae}from"./vue-boring-avatars-BxDa2gtD.js";const le={class:"ma-8"},P=16,B={__name:"userpage",setup(se){const{api:D}=Z(),o=M(),E=T(),F=ee(),m=d(!1),y=d(null),c=d([]),i=d(1),p=T(),I=_(()=>Math.ceil(c.value.length/P)),N=_(()=>{var e;return((e=E.user)==null?void 0:e.id)===o.params.id});console.log("🛑 route.params:",o.params);const r=d("created"),h=_(()=>c.value.filter(e=>r.value==="created"?e.user.toString()===o.params.id:F.collectedPosts.includes(e._id)).slice((i.value-1)*P,i.value*P)),g=async()=>{if(console.log("route.params.id:",o.params.id),!o.params.id){console.error("❌ 無法獲取用戶 ID，請確認用戶是否已正確進入頁面");return}if(!m.value){m.value=!0,y.value=null;try{const e=r.value==="created"?"/post/userposts/"+o.params.id:"/userCollect/collected/"+o.params.id;console.log("🚀 API 請求路徑:",e);const{data:s}=await D.get(e);if(!(s!=null&&s.result))throw new Error("無效的回應格式");c.value=s.result,console.log("✅ 獲取的文章:",c.value)}catch(e){console.error("❌ 獲取文章失敗:",e),e.value="無法取得文章資料",c.value=[]}finally{m.value=!1}}},b=e=>{r.value!==e&&(r.value=e,i.value=1,g())};return j(r,g),j(()=>o.params.id,()=>{g()}),U(()=>{g()}),(e,s)=>(n(),u(Y,{style:{"margin-top":"50px"}},{default:a(()=>[x("div",le,[l(V,{class:"d-flex justify-center align-center text-snow"},{default:a(()=>[l(f,{cols:"2"},{default:a(()=>{var t;return[l(v(ae),{size:200,variant:"beam",name:((t=v(p))==null?void 0:t.account)||"Guest",title:!0,style:{"margin-right":"10px"}},null,8,["name"])]}),_:1}),l(f,{cols:"6",style:{"margin-left":"50px"},class:"text-snow"},{default:a(()=>[l(R,{variant:"text",class:"d-flex flex-column text-h5 content text-klee-one"},{default:a(()=>[l(G,{style:{"margin-top":"10px"},class:"usrAccount"},{default:a(()=>{var t;return[x("h2",null,k(((t=v(p))==null?void 0:t.account)||"未知用戶"),1),N.value?(n(),u(C,{key:0,icon:"mdi-pencil",variant:"text",class:"text-snow"})):w("",!0)]}),_:1}),l(L,null,{default:a(()=>{var t;return[x("p",null,k(((t=v(p))==null?void 0:t.introduce)||"尚無介紹"),1)]}),_:1})]),_:1})]),_:1}),l(f,{cols:"12",class:"d-flex justify-center align-center"},{default:a(()=>[l(C,{text:"已建立",class:"text-body-2 me-4 font-weight-bold rounded-lg text-klee-one",variant:r.value==="created"?"flat":"outlined",color:(r.value==="created","#F1D87F"),onClick:s[0]||(s[0]=t=>b("created"))},null,8,["variant","color"]),l(C,{text:"已收藏",class:"text-body-2 ms-4 font-weight-bold rounded-lg text-klee-one",variant:r.value==="favorite"?"flat":"outlined",color:(r.value==="favorite","#C04759"),onClick:s[1]||(s[1]=t=>b("favorite"))},null,8,["variant","color"])]),_:1})]),_:1}),h.value.length>0?(n(),u(V,{key:0,class:"d-flex justify-center"},{default:a(()=>[(n(!0),$(O,null,q(h.value,t=>(n(),u(f,{key:t.id,cols:"12",md:"6",lg:"3",class:"mt-4"},{default:a(()=>{var S;return[l(te,H({ref_for:!0},t,{account:(S=v(p))==null?void 0:S.account}),null,16,["account"])]}),_:2},1024))),128)),l(f,{cols:"12"},{default:a(()=>[l(J,{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=t=>i.value=t),length:I.value},null,8,["modelValue","length"])]),_:1})]),_:1})):(n(),u(V,{key:1,class:"d-flex justify-center text-center text-snow text-body-2 mt-8 text-klee-one"},{default:a(()=>s[3]||(s[3]=[x("p",null," 尚無文章 ",-1)])),_:1}))]),m.value?(n(),u(K,{key:0,class:"d-flex align-center justify-center"},{default:a(()=>[l(Q,{indeterminate:""})]),_:1})):w("",!0),y.value?(n(),u(W,{key:1,type:"error",variant:"tonal",class:"ma-4"},{default:a(()=>[X(k(y.value),1)]),_:1})):w("",!0)]),_:1}))}};typeof A=="function"&&A(B);const ue=z(B,[["__scopeId","data-v-e853395f"]]);export{ue as default};
